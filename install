#!/bin/zsh

DOTFILES_PATH="$HOME/.dotfiles"

echo "Installing Homebrew"
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"

echo "Installing coreutils, git, openssl"
brew install coreutils git openssl

if [ ! -d "$DOTFILES_PATH" ]; then
  echo "Installing dotfiles"
  git clone "https://github.com/mrrooijen/dotfiles.git" "$DOTFILES_PATH"
fi

echo "Creating $HOME/Developer directory"
mkdir -p "$HOME/Developer"

echo "Linking zsh configuration"
ln -vnfs "$DOTFILES_PATH/zsh/zshrc" "$HOME/.zshrc"
ln -vnfs "$DOTFILES_PATH/zsh/zshenv" "$HOME/.zshenv"

echo "Linking ssh configuration"
mkdir -p "$HOME/.ssh"
ln -vnfs "$DOTFILES_PATH/ssh/config" "$HOME/.ssh/config"

echo "Linking git configuration"
ln -vnfs "$DOTFILES_PATH/git/gitconfig" "$HOME/.gitconfig"

echo "Initializing $zshrc_local"
touch "$HOME/.zshrc.local"

echo "Linking emacs configuration"
mkdir -p "$HOME/.emacs.d/straight/versions"
ln -vnfs "$DOTFILES_PATH/emacs/init.el" "$HOME/.emacs.d/init.el"
ln -vnfs "$DOTFILES_PATH/emacs/straight.lock.el" "$HOME/.emacs.d/straight/versions/default.el"

echo "Installing iTerm2"
brew install --cask iterm2

echo "Installing Rectangle"
brew install --cask rectangle

echo "Installing Emacs"
brew install emacs-plus@31

echo "Installing Mise"
brew install mise libyaml

echo "Done"
